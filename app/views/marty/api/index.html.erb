<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title> <%= app_name = Rails.application.class.parent_name %> API </title>
    <%= stylesheet_link_tag 'index' %>
    <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous">
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
	    integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
	    crossorigin="anonymous">
    </script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js"
      integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em"
      crossorigin="anonymous">
    </script>

    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css"
      integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B"
      crossorigin="anonymous">

    <style>
      html, body {
        height: 100%;
      }
      body {
        display: -ms-flexbox;
        display: -webkit-box;
        display: flex;
        -ms-flex-align: center;
        -ms-flex-pack: center;
        -webkit-box-align: center;
        align-items: center;
        -webkit-box-pack: center;
        justify-content: center;
        padding-top: 40px;
        padding-bottom: 40px;
        background-color: #f5f5f5;
      }
      .form {
        width: 100%;
        max-width: 330px;
        padding: 15px;
        margin: 0 auto;
      }
        .form .form-control {
        position: relative;
        box-sizing: border-box;
        height: auto;
        padding: 10px;
        font-size: 16px;
      }
      .form .form-control:focus {
        z-index: 2;
      }
      .form input[type="top"] {
        margin-bottom: -1px;
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
      }
      .form input[type="middle"] {
        margin-bottom: -1px;
        border-radius: 0;
      }
      .form input[type="bottom"], .form input[type="password"] {
        margin-bottom: 10px;
        border-top-left-radius: 0;
        border-top-right-radius: 0;
      }
      .form input[type="single"] {
        margin-bottom: 10px;
      }
      .link {
      margin-top: 10px;
      display: block;
      }
    </style>

  </head>
  <body class="text-center">
    <% params_path = {
      'sign_in'                 => api_sign_in_path,
      'forgot_password'         => api_forgot_password_path,
      'confirm_forgot_password' => api_confirm_forgot_password_path,
      'confirm_sign_up'         => api_confirm_sign_up_path,
      'sign_up'                 => api_sign_up_path,
    } %>

    <%= form_for :user, :url => params_path[@path],
    html: {class: 'form'} do |f| %>

    <img src="https://www.s2.divertazas.com/58596-large_default/cojin-con-relleno-chibi-kawaii-marty-mcfly-parodia-de-regreso-al-futuro.jpg" height="250px">
    <h1 class="h3 mb-3 font-weight-normal"><%= app_name %> API</h1>
      <% flash.each do |key, value| %>
        <div class="alert alert-<%= key %>"><%= value %></div>
      <% end %>

      <% if @path == 'sign_up' %>
        <%= f.text_field :invite_token,
	    minlength: 32,
	    maxlength: 32,
	    placeholder: 'invite token',
	    class: 'form-control',
	    required: true,
	    autofocus: true,
	    type: 'top' %>
        <%= f.email_field :email,
	    placeholder: 'youremail@gmail.com',
	    class: 'form-control',
	    required: true,
	    type: 'middle' %>
      <% end %>

      <% if @path == 'confirm_sign_up' %>
        <%= f.hidden_field :username, value: @username %>
        <%= f.text_field :confirmation_code,
	    placeholder: 'confirmation code',
	    class: 'form-control',
	    required: true,
	    type: 'single' %>
      <% elsif @path == 'confirm_forgot_password' %>
        <%= f.hidden_field :username, value: @username %>
        <%= f.text_field :confirmation_code,
	    placeholder: 'confirmation code',
	    class: 'form-control',
	    required: true,
	    type: 'middle' %>
	<%= f.password_field :password,
	    placeholder: 'password',
	    class: 'form-control',
	    required: true,
	    type: 'password' %>
      <% elsif @path == 'forgot_password' %>
        <%= f.text_field :username,
	  placeholder: 'username',
	  class: 'form-control',
	  required: true,
	  autofocus: true,
	  type: 'single'  %>
      <% else %>
        <%= f.text_field :username,
	  placeholder: 'username',
	  class: 'form-control',
	  required: true,
	  autofocus: @path != 'sign_up',
	  type: @path == 'sign_up' ? 'middle' : 'top'  %>
	<%= f.password_field :password,
	    placeholder: 'password',
	    class: 'form-control',
	    required: true,
	    type: 'password' %>
      <% end %>

      <%= f.submit (@path && !@path.include?('sign_in')) ? 'Submit' : 'Test',
	  class: 'btn btn-lg btn-primary btn-block' %>

      <% if @path && @path == 'sign_in' %>
        <a href="<%= api_path + '?path=sign_up' %>" class="btn btn-lg btn-success btn-block">Sign up</a>
        <a href="<%= api_path + '?path=forgot_password' %>" class="link">Forgot Password</a>
      <% end %>

    <% end %>
  </body>
</html>
